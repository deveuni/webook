<?xml version="1.0" encoding="UTF-8"?>

<!-- DTD지정  -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.webook.mapper.ShopMapper">

<!-- 카트 담기 -->
<insert id="addCart">
	insert into tbl_cart (userId, gdsNum, cartStock, addDate) 
	 values (#{userId}, #{gdsNum}, #{cartStock}, now())
</insert>

<!-- 카트 리스트 -->
<select id="cartList" resultType="com.webook.domain.CartListVO">
	select 
	  @rownum := @rownum + 1 as num, 
   	  c.cartNum, c.userId, c.gdsNum, c.cartStock, c.addDate, 
      g.gdsName, g.gdsPrice, g.gdsImg
    from tbl_cart c
        inner join tbl_goods g
            on c.gdsNum = g.gdsNum
            , (select @rownum := 0) as R
	where c.userId = #{userId}
</select>
 



<!-- 
	select 
	  row_number() over(order by c.cartNum desc) as num, 
	  c.cartNum, c.userId, c.gdsNum, c.cartStock, c.addDate, 
	  g.gdsName, g.gdsPrice, g.gdsImg 
	from tbl_cart c
		inner join tbl_goods g
			on c.gdsNum = g.gdsNum
		where c.userId = #{userId}  

 -->
 
<!-- 카트삭제  -->
<delete id="deleteCart">
	delete from tbl_cart 
	 where cartNum = #{cartNum} and userId = #{userId}
</delete>

<!--  -->
<!--  -->
<!--  -->
<!--  -->



</mapper>  